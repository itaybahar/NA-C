@page "/"
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthStateProvider
@inject Blazor_WebAssembly.Services.Interfaces.IJSRuntimeService JSRuntime

<h1>מחסן הנשיא</h1>

<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>גישה מהירה</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a class="btn btn-primary" href="/EquipmentInventory">
                        מצאי ציוד
                    </a>
                    <a class="btn btn-primary" href="/EquipmentRequestList">
                        בקשות ציוד
                    </a>
                    <a class="btn btn-primary" href="/EquipmentCheckout">
                        השאלת ציוד
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            var authState = await AuthStateProvider.GetAuthenticationStateAsync();
            var user = authState.User;

            // Navigate to login page if the user is not authenticated
            if (!user.Identity?.IsAuthenticated ?? true)
            {
                NavigationManager.NavigateTo("/login");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error in Index.razor initialization: {ex.Message}");
            // Still navigate to login on error
            NavigationManager.NavigateTo("/login");
        }
    }
}
